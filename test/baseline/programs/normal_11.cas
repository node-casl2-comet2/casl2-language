CASL        START   
            LAD     GR6, 0
            LAD     GR7, LIBBUF
            LAD     GR5, GVAR
            LD      GR3, =6
            ST      GR3, C0C0B4AB
            LD      GR3, =7
            XOR     GR3, =#FFFF
            ADDA    GR3, =1
            ST      GR3, B122C528
            LD      GR3, =8
            XOR     GR3, =#FFFF
            ADDA    GR3, =1
            ST      GR3, CE4B16B2
            LD      GR3, ='A'
            ST      GR3, C69ED3BC
            LD      GR3, ='b'
            ST      GR3, D0D7FDB6
            LD      GR3, =1
            ST      GR3, B1F05844
            LD      GR3, =0
            ST      GR3, C9F9D7DD
            LD      GR3, C0C0B4AB
            ST      GR3, DB95E8E1
            LD      GR1, DB95E8E1
            PUSH    0, GR1
            LD      GR2, =6
            POP     GR1
            SUBA    GR1, GR2
            LD      GR3, GR1
            ST      GR3, DB95E8E1
            LD      GR1, =8
            PUSH    0, GR1
            LD      GR2, B122C528
            POP     GR1
            ADDA    GR1, GR2
            LD      GR3, GR1
            ST      GR3, F8F57715
            LD      GR1, =3
            PUSH    0, GR1
            LD      GR2, C0C0B4AB
            POP     GR1
            ADDA    GR1, GR2
            LD      GR3, GR1
            PUSH    0, GR1
            LD      GR2, =2
            POP     GR1
            ADDA    GR1, GR2
            LD      GR3, GR1
            PUSH    0, GR1
            LD      GR2, B122C528
            POP     GR1
            SUBA    GR1, GR2
            LD      GR3, GR1
            PUSH    0, GR1
            LD      GR2, CE4B16B2
            POP     GR1
            ADDA    GR1, GR2
            LD      GR3, GR1
            PUSH    0, GR1
            LD      GR2, =8
            POP     GR1
            SUBA    GR1, GR2
            LD      GR3, GR1
            ST      GR3, B8B965AD
            LD      GR3, DB95E8E1
            ST      GR3, DAA6880D
            LD      GR3, F8F57715
            ST      GR3, A8BB7CD3
            LD      GR3, B8B965AD
            ST      GR3, A9FDD4C2
            LD      GR1, B122C528
            PUSH    0, GR1
            LD      GR2, C0C0B4AB
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I1XGD
            JZE     I1XGD
            LAD     GR1, 1
            JUMP    I1XGDEND
I1XGD       LAD     GR1, 0
I1XGDEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I8UE6END
I8UE6       LD      GR3, =3
            ST      GR3, DB95E8E1
I8UE6END    NOP     
            LD      GR1, CE4B16B2
            PUSH    0, GR1
            LD      GR1, C0C0B4AB
            PUSH    0, GR1
            LD      GR2, =7
            POP     GR1
            SUBA    GR1, GR2
            LD      GR2, GR1
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     ICZPD
            LAD     GR1, 1
            JUMP    ICZPDEND
ICZPD       LAD     GR1, 0
ICZPDEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     ITXTSEND
ITXTS       LD      GR3, =4
            ST      GR3, F8F57715
ITXTSEND    NOP     
            LD      GR1, CE4B16B2
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
            PUSH    0, GR1
            LD      GR2, =2
            POP     GR1
            SUBA    GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR2, =6
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I02WW
            JMI     I02WW
            LAD     GR1, 1
            JUMP    I02WWEND
I02WW       LAD     GR1, 0
I02WWEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I2XWFEND
I2XWF       LD      GR3, =5
            ST      GR3, B8B965AD
I2XWFEND    NOP     
            LD      GR3, DB95E8E1
            ST      GR3, D607A663
            LD      GR3, F8F57715
            ST      GR3, F782A148
            LD      GR3, B8B965AD
            ST      GR3, CFE6C192
            LD      GR1, C0C0B4AB
            PUSH    0, GR1
            LD      GR2, B122C528
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JMI     IJ0UO
            JZE     IJ0UO
            LAD     GR1, 1
            JUMP    IJ0UOEND
IJ0UO       LAD     GR1, 0
IJ0UOEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     INCBQEND
INCBQ       LD      GR3, =6
            ST      GR3, DB95E8E1
INCBQEND    NOP     
            LD      GR1, C0C0B4AB
            PUSH    0, GR1
            LD      GR1, CE4B16B2
            PUSH    0, GR1
            LD      GR2, =7
            POP     GR1
            ADDA    GR1, GR2
            LD      GR2, GR1
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JMI     I20TT
            LAD     GR1, 1
            JUMP    I20TTEND
I20TT       LAD     GR1, 0
I20TTEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I4H9NEND
I4H9N       LD      GR3, =7
            ST      GR3, F8F57715
I4H9NEND    NOP     
            LD      GR1, CE4B16B2
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
            PUSH    0, GR1
            LD      GR2, =2
            POP     GR1
            ADDA    GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR2, =5
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     IW3UW
            LAD     GR1, 1
            JUMP    IW3UWEND
IW3UW       LAD     GR1, 0
IW3UWEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     ISYSVEND
ISYSV       LD      GR3, =8
            ST      GR3, B8B965AD
ISYSVEND    NOP     
            LD      GR3, DB95E8E1
            ST      GR3, F74DD50C
            LD      GR3, F8F57715
            ST      GR3, C6925622
            LD      GR3, B8B965AD
            ST      GR3, C42382C8
            LD      GR1, C0C0B4AB
            PUSH    0, GR1
            LD      GR2, B122C528
            POP     GR1
            CALL    MULT
            LD      GR1, GR2
            LD      GR1, GR2
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
            PUSH    0, GR1
            LD      GR1, B122C528
            PUSH    0, GR1
            LD      GR2, =1
            POP     GR1
            CALL    MULT
            LD      GR2, GR2
            LD      GR1, GR2
            POP     GR1
            ADDA    GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR1, =2
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
            PUSH    0, GR1
            LD      GR2, C0C0B4AB
            POP     GR1
            CALL    MULT
            LD      GR2, GR2
            LD      GR1, GR2
            POP     GR1
            ADDA    GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR1, C0C0B4AB
            PUSH    0, GR1
            LD      GR2, =3
            POP     GR1
            CALL    DIV
            LD      GR1, GR2
            LD      GR1, GR2
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
            PUSH    0, GR1
            LD      GR1, B122C528
            PUSH    0, GR1
            LD      GR2, =7
            POP     GR1
            CALL    DIV
            LD      GR2, GR2
            LD      GR1, GR2
            POP     GR1
            SUBA    GR1, GR2
            LD      GR2, GR1
            PUSH    0, GR1
            LD      GR1, CE4B16B2
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
            PUSH    0, GR1
            LD      GR1, =1
            PUSH    0, GR1
            LD      GR1, =2
            PUSH    0, GR1
            LD      GR1, CE4B16B2
            PUSH    0, GR1
            LD      GR2, C0C0B4AB
            POP     GR1
            ADDA    GR1, GR2
            LD      GR2, GR1
            POP     GR1
            ADDA    GR1, GR2
            LD      GR2, GR1
            POP     GR1
            ADDA    GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR2, =2
            POP     GR1
            SUBA    GR1, GR2
            LD      GR2, GR1
            XOR     GR2, =#FFFF
            ADDA    GR2, =1
            POP     GR1
            CALL    DIV
            LD      GR2, GR1
            POP     GR1
            ADDA    GR1, GR2
            LD      GR2, GR1
            POP     GR1
            SUBA    GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR2, =24
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I7RHX
            LAD     GR1, 1
            JUMP    I7RHXEND
I7RHX       LAD     GR1, 0
I7RHXEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     KDSU0
IDSU0       LD      GR3, =0
            ST      GR3, DB95E8E1
            JUMP    IDSU0END
KDSU0       LD      GR3, =9
            ST      GR3, DB95E8E1
IDSU0END    NOP     
            LD      GR3, DB95E8E1
            ST      GR3, D1E97D18
            LD      GR2, DAA6880D
            CALL    WRTINT
            LD      GR2, A8BB7CD3
            CALL    WRTINT
            LD      GR2, A9FDD4C2
            CALL    WRTINT
            LD      GR2, D607A663
            CALL    WRTINT
            LD      GR2, F782A148
            CALL    WRTINT
            LD      GR2, CFE6C192
            CALL    WRTINT
            LD      GR2, F74DD50C
            CALL    WRTINT
            LD      GR2, C6925622
            CALL    WRTINT
            LD      GR2, C42382C8
            CALL    WRTINT
            LD      GR2, D1E97D18
            CALL    WRTINT
            CALL    WRTLN
            LD      GR1, B122C528
            PUSH    0, GR1
            LD      GR2, C0C0B4AB
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I9QJM
            JZE     I9QJM
            LAD     GR1, 1
            JUMP    I9QJMEND
I9QJM       LAD     GR1, 0
I9QJMEND    LD      GR3, GR1
            ST      GR3, C47EE1B1
            LD      GR1, C47EE1B1
            PUSH    0, GR1
            LD      GR1, CE4B16B2
            PUSH    0, GR1
            LD      GR2, =0
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I1Z9E
            JZE     I1Z9E
            LAD     GR1, 1
            JUMP    I1Z9EEND
I1Z9E       LAD     GR1, 0
I1Z9EEND    LD      GR2, GR1
            POP     GR1
            AND     GR1, GR2
            LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     ICYB1END
ICYB1       LD      GR3, =0
            ST      GR3, DB95E8E1
ICYB1END    NOP     
            LD      GR1, C47EE1B1
            PUSH    0, GR1
            LD      GR1, CE4B16B2
            PUSH    0, GR1
            LD      GR2, =0
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     IOWOA
            JZE     IOWOA
            LAD     GR1, 1
            JUMP    IOWOAEND
IOWOA       LAD     GR1, 0
IOWOAEND    LD      GR2, GR1
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I8OYZ
            JMI     I8OYZ
            LAD     GR1, 1
            JUMP    I8OYZEND
I8OYZ       LAD     GR1, 0
I8OYZEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I7UPYEND
I7UPY       LD      GR3, =1
            ST      GR3, F8F57715
I7UPYEND    NOP     
            LD      GR1, =1
            PUSH    0, GR1
            LD      GR2, C47EE1B1
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I7DP8
            LAD     GR1, 1
            JUMP    I7DP8END
I7DP8       LAD     GR1, 0
I7DP8END    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I02A8END
I02A8       LD      GR3, =2
            ST      GR3, B8B965AD
I02A8END    NOP     
            LD      GR3, DB95E8E1
            ST      GR3, DAA6880D
            LD      GR3, F8F57715
            ST      GR3, A8BB7CD3
            LD      GR3, B8B965AD
            ST      GR3, A9FDD4C2
            LD      GR1, C9F9D7DD
            PUSH    0, GR1
            LD      GR2, B1F05844
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I859Z
            JZE     I859Z
            LAD     GR1, 1
            JUMP    I859ZEND
I859Z       LAD     GR1, 0
I859ZEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     IM1HMEND
IM1HM       LD      GR3, =3
            ST      GR3, DB95E8E1
IM1HMEND    NOP     
            LD      GR1, C47EE1B1
            PUSH    0, GR1
            LD      GR2, B1F05844
            POP     GR1
            AND     GR1, GR2
            LD      GR1, GR1
            XOR     GR1, =#FFFF
            PUSH    0, GR1
            LD      GR2, C9F9D7DD
            POP     GR1
            OR      GR1, GR2
            LD      GR1, GR1
            XOR     GR1, =#FFFF
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I531REND
I531R       LD      GR3, =4
            ST      GR3, F8F57715
I531REND    NOP     
            LD      GR1, =1
            PUSH    0, GR1
            LD      GR2, =0
            POP     GR1
            OR      GR1, GR2
            LD      GR1, GR1
            PUSH    0, GR1
            LD      GR1, =1
            PUSH    0, GR1
            LD      GR2, =0
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     ITJWF
            LAD     GR1, 1
            JUMP    ITJWFEND
ITJWF       LAD     GR1, 0
ITJWFEND    LD      GR2, GR1
            POP     GR1
            AND     GR1, GR2
            LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I60UFEND
I60UF       LD      GR3, =5
            ST      GR3, B8B965AD
I60UFEND    NOP     
            LD      GR3, DB95E8E1
            ST      GR3, D607A663
            LD      GR3, F8F57715
            ST      GR3, F782A148
            LD      GR3, B8B965AD
            ST      GR3, CFE6C192
            LD      GR1, C69ED3BC
            PUSH    0, GR1
            LD      GR2, D0D7FDB6
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     IVHVG
            LAD     GR1, 1
            JUMP    IVHVGEND
IVHVG       LAD     GR1, 0
IVHVGEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I0PQYEND
I0PQY       LD      GR3, =6
            ST      GR3, DB95E8E1
I0PQYEND    NOP     
            LD      GR1, C69ED3BC
            PUSH    0, GR1
            LD      GR2, ='A'
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I1SY8
            JMI     I1SY8
            LAD     GR1, 1
            JUMP    I1SY8END
I1SY8       LAD     GR1, 0
I1SY8END    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     IZVOOEND
IZVOO       LD      GR3, =7
            ST      GR3, F8F57715
IZVOOEND    NOP     
            LD      GR1, D0D7FDB6
            PUSH    0, GR1
            LD      GR2, ='b'
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     I3JCA
            LAD     GR1, 1
            JUMP    I3JCAEND
I3JCA       LAD     GR1, 0
I3JCAEND    LD      GR1, GR1
            XOR     GR1, =#FFFF
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     IASU0END
IASU0       LD      GR3, =8
            ST      GR3, B8B965AD
IASU0END    NOP     
            LD      GR3, DB95E8E1
            ST      GR3, F74DD50C
            LD      GR3, F8F57715
            ST      GR3, C6925622
            LD      GR3, B8B965AD
            ST      GR3, C42382C8
            LD      GR2, DAA6880D
            CALL    WRTINT
            LD      GR2, A8BB7CD3
            CALL    WRTINT
            LD      GR2, A9FDD4C2
            CALL    WRTINT
            LD      GR2, D607A663
            CALL    WRTINT
            LD      GR2, F782A148
            CALL    WRTINT
            LD      GR2, CFE6C192
            CALL    WRTINT
            LD      GR2, F74DD50C
            CALL    WRTINT
            LD      GR2, C6925622
            CALL    WRTINT
            LD      GR2, C42382C8
            CALL    WRTINT
            LD      GR2, ='9'
            CALL    WRTCH
            CALL    WRTLN
            LD      GR3, =2
            XOR     GR3, =#FFFF
            ADDA    GR3, =1
            ST      GR3, B8B965AD
LSOYJ       LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =10
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     IW94A
            LAD     GR1, 1
            JUMP    IW94AEND
IW94A       LAD     GR1, 0
IW94AEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     LSOYJEND
            LD      GR3, D0D7FDB6
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
            LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =1
            POP     GR1
            ADDA    GR1, GR2
            LD      GR3, GR1
            ST      GR3, B8B965AD
            JUMP    LSOYJ
LSOYJEND    NOP     
            LD      GR3, =2
            XOR     GR3, =#FFFF
            ADDA    GR3, =1
            ST      GR3, B8B965AD
LSQ5F       LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =10
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     ISSFQ
            LAD     GR1, 1
            JUMP    ISSFQEND
ISSFQ       LAD     GR1, 0
ISSFQEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     LSQ5FEND
            LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =2
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I35CG
            JZE     I35CG
            LAD     GR1, 1
            JUMP    I35CGEND
I35CG       LAD     GR1, 0
I35CGEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     KXUU4
IXUU4       LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =0
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     IFWFZ
            JZE     IFWFZ
            LAD     GR1, 1
            JUMP    IFWFZEND
IFWFZ       LAD     GR1, 0
IFWFZEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     KSSJ2
ISSJ2       LD      GR3, C69ED3BC
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
            JUMP    ISSJ2END
KSSJ2       LD      GR3, ='B'
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
ISSJ2END    NOP     
            JUMP    IXUU4END
KXUU4       LD      GR3, ='C'
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
IXUU4END    NOP     
            LD      GR3, ='D'
            ST      GR3, AEB3A9ED
            LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =4
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JMI     IOBS6
            LAD     GR1, 1
            JUMP    IOBS6END
IOBS6       LAD     GR1, 0
IOBS6END    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     IDS1ZEND
IDS1Z       LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =8
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     IB27B
            JZE     IB27B
            LAD     GR1, 1
            JUMP    IB27BEND
IB27B       LAD     GR1, 0
IB27BEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     K4W4Z
I4W4Z       LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =6
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     I80PF
            JZE     I80PF
            LAD     GR1, 1
            JUMP    I80PFEND
I80PF       LAD     GR1, 0
I80PFEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     KSDH1
ISDH1       LD      GR3, AEB3A9ED
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
            JUMP    ISDH1END
KSDH1       LD      GR3, ='E'
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
ISDH1END    NOP     
            JUMP    I4W4ZEND
K4W4Z       LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =9
            POP     GR1
            SUBA    GR1, GR2
            LAD     GR2, 0
            CPA     GR1, GR2
            JPL     IFB9V
            LAD     GR1, 1
            JUMP    IFB9VEND
IFB9V       LAD     GR1, 0
IFB9VEND    LD      GR1, GR1
            LAD     GR2, 0
            CPA     GR1, GR2
            JZE     KCM2O
ICM2O       LD      GR3, ='f'
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
            JUMP    ICM2OEND
KCM2O       LD      GR3, ='g'
            LD      GR4, B8B965AD
            LAD     GR0, -2
            SUBA    GR4, GR0
            ST      GR3, BE97D9AF, GR4
ICM2OEND    NOP     
I4W4ZEND    NOP     
IDS1ZEND    NOP     
            LD      GR1, B8B965AD
            PUSH    0, GR1
            LD      GR2, =1
            POP     GR1
            ADDA    GR1, GR2
            LD      GR3, GR1
            ST      GR3, B8B965AD
            JUMP    LSQ5F
LSQ5FEND    NOP     
            LAD     GR2, ='AABBCCDDEEffg'
            LAD     GR1, 13
            CALL    WRTSTR
            CALL    WRTLN
            LAD     GR2, BE97D9AF
            LAD     GR1, 13
            CALL    WRTSTR
            CALL    WRTLN
            RET     
LIBBUF      DS      256
GVAR        NOP     
DAA6880D    DS      1
A8BB7CD3    DS      1
A9FDD4C2    DS      1
D607A663    DS      1
F782A148    DS      1
CFE6C192    DS      1
F74DD50C    DS      1
C6925622    DS      1
C42382C8    DS      1
D1E97D18    DS      1
C47EE1B1    DS      1
AD0BD836    DS      1
C9F9D7DD    DS      1
B1F05844    DS      1
C69ED3BC    DS      1
D0D7FDB6    DS      1
E0323A90    DS      1
AEB3A9ED    DS      1
C0C0B4AB    DS      1
B122C528    DS      1
CE4B16B2    DS      1
DB95E8E1    DS      1
F8F57715    DS      1
B8B965AD    DS      1
BE97D9AF    DS      13
            END     
;====================
; MULT: 掛け算を行うサブルーチン
; GR1 * GR2 -> GR2
MULT        START
            PUSH    0, GR1 ; GR1 の内容をスタックに退避
            PUSH    0, GR3 ; GR3 の内容をスタックに退避
            PUSH    0, GR4 ; GR4 の内容をスタックに退避
            LAD     GR3, 0 ; GR3 を初期化
            LD      GR4, GR2
            JPL     LOOP
            XOR     GR4, =#FFFF
            ADDA    GR4, =1
LOOP        SRL     GR4, 1
            JOV     ONE
            JUMP    ZERO
ONE         ADDL    GR3, GR1
ZERO        SLL     GR1, 1
            AND     GR4, GR4
            JNZ     LOOP
            CPA     GR2, =0
            JPL     END
            XOR     GR3, =#FFFF
            ADDA    GR3, =1
END         LD      GR2,GR3
            POP     GR4
            POP     GR3
            POP     GR1
            RET
            END
;====================
; DIV 割り算を行うサブルーチン
; GR1 / GR2 -> 商は GR2, 余りは GR1
DIV         START
            PUSH    0, GR3
            ST      GR1, A
            ST      GR2, B
            CPA     GR1, =0
            JPL     SKIPA
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
SKIPA       CPA     GR2, =0
            JZE     SKIPD
            JPL     SKIPB
            XOR     GR2, =#FFFF
            ADDA    GR2, =1
SKIPB       LD      GR3, =0
LOOP        CPA     GR1, GR2
            JMI     STEP
            SUBA    GR1, GR2
            LAD     GR3, 1, GR3
            JUMP    LOOP
STEP        LD      GR2, GR3
            LD      GR3, A
            CPA     GR3, =0
            JPL     SKIPC
            XOR     GR1, =#FFFF
            ADDA    GR1, =1
SKIPC       XOR     GR3, B
            CPA     GR3, =0
            JZE     SKIPD
            JPL     SKIPD
            XOR     GR2, =#FFFF
            ADDA    GR2, =1
SKIPD       POP     GR3
            RET
A           DS    1
B           DS    1
            END
;====================
; 入力装置から数値データを読み込み，
; その内容を GR2 が指すアドレスに格納するサブルーチン
RDINT       START
            PUSH    0, GR1 ; GR1 の内容をスタックに退避
            PUSH    0, GR3 ; GR3 の内容をスタックに退避
            PUSH    0, GR4 ; GR4 の内容をスタックに退避
            PUSH    0, GR5 ; GR5 の内容をスタックに退避
            PUSH    0, GR6 ; GR6 の内容をスタックに退避
            LD      GR5, GR2 ; GR2 が指す番地を GR5 にコピー
            LD      GR2, =0 ; GR2 を初期化
            LD      GR3, =0 ; GR3 を初期化
            IN      INAREA, INLEN ; 入力を受け取る
            ; 入力がnullかどうかのチェック
            CPA     GR3, INLEN
            JZE     ERROR
            ; 最初の文字が'-'かどうかのチェック
            LD      GR4,INAREA,GR3
            LAD     GR3,1,GR3
            LD      GR6,GR4 ; GR6 に入力された先頭の文字を保存
            CPL     GR4,=#002D ; '-'かどうか
            JZE     LOOP
            CPL     GR4,='0' ; 数値かどうかのチェック
            JMI     ERROR
            CPL     GR4,='9' 
            JPL     ERROR
            XOR     GR4,=#0030 ; 数値だったら変換
            ADDA    GR2,GR4
            ; 「すでに読み込んだ数値を10倍して，
            ; 新しく読み込んだ数値と足す．」を繰り返す
LOOP        CPA     GR3, INLEN
            JZE     CODE ; 入力された文字数とGR3が同じであればループを抜ける
            LD      GR1, =10
            CALL    MULT ; GR2 の値を10倍する
            LD      GR4, INAREA, GR3
            CPL     GR4, ='0' ; 数値かどうかのチェック
            JMI     ERROR
            CPL     GR4, ='9' 
            JPL     ERROR
            XOR     GR4, =#0030 ; GR4 の内容を数値に変換
            ADDA    GR2, GR4 ; GR2 に GR1 の内容を足す
            LAD     GR3, 1, GR3; GR3 (ポインタ)をインクリメント
            JUMP    LOOP
            ; 最初の文字が '-'であった場合は，-1倍する
CODE        CPL     GR6, =#002D
            JNZ     END
            XOR     GR2, =#FFFF
            LAD     GR2, 1, GR2
            JUMP    END
            ; エラーを出力する
ERROR       OUT     ERRSTR, ERRLEN
END         ST      GR2, 0, GR5 ; GR2 の内容を GR5 が指す番地に格納する
            LD      GR2, GR5 ; GR5 が指す番地を GR2 に戻す
            POP     GR6
            POP     GR5
            POP     GR4
            POP     GR3
            POP     GR1
            RET
ERRSTR      DC      'illegal input'
ERRLEN      DC      13
INAREA      DS      6
INLEN       DS      1
            END
;====================
; 入力装置から文字を読み込み，
; その内容を GR2 が指すアドレスに格納するサブルーチン
RDCH        START
            IN      INCHAR, INLEN
            LD      GR1, INCHAR
            ST      GR1, 0, GR2
            RET
INCHAR      DS      1
INLEN       DS      1
            END
;====================
; 入力装置から，GR1の文字数を読み込む．
; 読み込んだ文字列は，GR2 が指すアドレスから順に格納される
RDSTR       START
            PUSH    0, GR3 ; GR3 の内容をスタックに退避
            PUSH    0, GR4 ; GR4 の内容をスタックに退避
            PUSH    0, GR5 ; GR5 の内容をスタックに退避
            LAD     GR4, 0 ; GR4 を初期化
            IN      INSTR, INLEN
LOOP        CPA     GR4, GR1
            JZE     END ; GR1で指定された文字数を超えたら終わり
            CPA     GR4, INLEN
            JZE     END ; 入力された文字数を超えたら終わり
            LD      GR5, GR2
            ADDA    GR5, GR4 ; 文字の格納先番地を計算
            LD      GR3, INSTR, GR4
            ST      GR3, 0, GR5
            LAD     GR4, 1, GR4
            JUMP    LOOP
END         POP     GR5
            POP     GR4
            POP     GR3
            RET
INSTR       DS      256
INLEN       DS      1
            END
;====================
; 入力装置からの文字列を改行まで読み飛ばすサブルーチン
RDLN        START
            IN      INAREA, INLEN
            RET
INAREA      DS      256
INLEN       DS      1
            END
;====================
; GR2 の内容（数値データ）を出力装置に書き出すサブルーチン
; このサブルーチンが呼ばれたとき，
; GR7 には，出力用番地の先頭アドレスが，
; GR6 には，現在出力用番地に入っている文字数が，
; それぞれ格納されている．
WRTINT      START
            PUSH    0, GR1 ; GR1の内容をスタックに退避
            PUSH    0, GR2 ; GR2の内容をスタックに退避
            PUSH    0, GR3 ; GR3の内容をスタックに退避
            PUSH    0, GR2 ; 数値データをもう一度スタックに退避
            LD      GR3, =0 ; GR3 はインデックスとして用いる
            ; 数値データが負数である場合は，正の数に変換
            CPA     GR2, =0
            JPL     LOOP1
            XOR     GR2, =#FFFF
            ADDA    GR2, =1
            ; 数値データを変換しながら，バッファに格納
LOOP1       LD      GR1, GR2
            LD      GR2, =10
            CALL    DIV
            XOR     GR1, =#0030
            ST      GR1,BUFFER,GR3
            LAD     GR3, 1, GR3
            CPA     GR2, =0
            JNZ     LOOP1
            ; 数値データが負数であれば，'-'を追加
            POP     GR2
            CPA     GR2, =0
            JZE     LOOP2
            JPL     LOOP2
            LD      GR1, ='-'
            ST      GR1, BUFFER, GR3
            LAD     GR3, 1, GR3
            ; BUFFER を逆順にたどりながら，出力用バッファに格納
LOOP2       LAD     GR3, -1, GR3
            LD      GR1, BUFFER, GR3
            LD      GR2, GR7
            ADDA    GR2, GR6
            ST      GR1, 0, GR2
            LAD     GR6, 1, GR6
            CPA     GR3, =0
            JNZ     LOOP2
END         POP     GR3
            POP     GR2
            POP     GR1
            RET
BUFFER      DS      6    
            END
;====================
; GR2 の内容（文字）を出力装置に書き出すサブルーチン
; このサブルーチンが呼ばれたとき，
; GR7 には，出力用番地の先頭アドレスが，
; GR6 には，現在出力用番地に入っている文字数が，
; それぞれ格納されている．
WRTCH       START
            PUSH    0, GR1 ; GR1 の内容をスタックに退避
            LD      GR1, GR7
            ADDA    GR1, GR6 ; GR1 に次の文字を格納する番地を代入
            ST      GR2, 0, GR1
            LAD     GR6, 1, GR6
            POP     GR1
            RET
            END
;====================
; GR2 の指すメモリ番地から，長さ GR1 の文字列を出力装置に書き出すサブルーチン
; このサブルーチンが呼ばれたとき，
; GR7 には，出力用番地の先頭アドレスが，
; GR6 には，現在出力用番地に入っている文字数が，
; それぞれ格納されている．
WRTSTR      START
            PUSH    0, GR3 ; GR3 の内容をスタックに退避
            PUSH    0, GR4 ; GR4 の内容をスタックに退避
            PUSH    0, GR5 ; GR5 の内容をスタックに退避
            LAD     GR3, 0 ; GR3 は制御変数として用いる
LOOP        CPA     GR3, GR1
            JZE     END
            LD      GR4, GR2
            ADDA    GR4, GR3 ; 出力する文字の格納番地を計算
            LD      GR5, 0, GR4 ; 出力する文字をレジスタにコピー
            LD      GR4, GR7
            ADDA    GR4, GR6 ; 出力先の番地を計算
            ST      GR5, 0, GR4 ; 出力装置に書き出し
            LAD     GR3, 1, GR3
            LAD     GR6, 1, GR6
            JUMP    LOOP
END         POP     GR5
            POP     GR4
            POP     GR3
            RET
            END
;====================
; 改行を出力装置に書き出すサブルーチン
; 実質的には，GR7で始まるアドレス番地から長さGR6の文字列を出力する
WRTLN       START
            PUSH    0, GR1
            PUSH    0, GR2
            PUSH    0, GR3
            ST      GR6, OUTLEN
            LAD     GR1, 0
LOOP        CPA     GR1, OUTLEN
            JZE     END
            LD      GR2, GR7
            ADDA    GR2, GR1
            LD      GR3, 0, GR2
            ST      GR3, OUTSTR, GR1
            LAD     GR1, 1, GR1
            JUMP    LOOP    
END         OUT     OUTSTR, OUTLEN
            LAD     GR6, 0 ; 文字列を出力して，GR6 を初期化
            POP     GR3
            POP     GR2
            POP     GR1
            RET
OUTSTR      DS      256
OUTLEN      DS      1
            END
